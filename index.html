<!DOCTYPE html>
<html lang="zh-Hant">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>讀稿提詞機 • Teleprompter</title>
    <meta name="description" content="讀稿提詞機（Teleprompter）是一款簡單易用的線上提詞工具，支援多語言、全螢幕顯示與自訂顏色，適合演講、錄影、直播使用。">
    <meta property="og:image" content="https://deanlin.net/teleprompter/preview.png">
    <meta property="og:title" content="讀稿提詞機 • Teleprompter">
    <meta property="og:description" content="讀稿提詞機（Teleprompter）是一款簡單易用的線上提詞工具，支援多語言、全螢幕顯示與自訂顏色，適合演講、錄影、直播使用。">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://deanlin.net/teleprompter/">
    <!-- Font Awesome Icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <style>
      :root {
        --control-bg: #222;
        --control-color: #fff;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: "Segoe UI", "PingFang TC", sans-serif;
        background: #f7f7f7;
        color: #333;
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }

      /* ===== 首頁區塊 ===== */
      #home {
        padding: 2rem 1rem;
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      h1 {
        margin-top: 0;
        margin-bottom: 0.5rem;
        font-size: 2rem;
        text-align: center;
      }

      .creator {
        font-size: 1.3rem;
        color: #444;
        margin-bottom: 0.7em;
        text-align: center;
        font-weight: 500;
      }
      .creator a {
        color: #007aff;
        text-decoration: none;
      }
      .creator a:hover {
        text-decoration: underline;
      }
      @media (max-width: 600px) {
        .creator {
          font-size: 1.1rem;
        }
      }

      /* LangSelect 美化樣式 */
      .lang-select {
        position: relative;
        min-width: 160px;
        user-select: none;
      }
      .lang-select__selected {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0.4em 1em;
        border-radius: 8px;
        cursor: pointer;
        border: 1.5px solid #ccc;
        background: #fff;
        color: #333;
        box-shadow: 0 2px 8px #0001;
        font-size: 1.08em;
        transition: border 0.2s, box-shadow 0.2s;
      }
      .lang-select__selected:hover {
        border: 1.5px solid #007aff;
        box-shadow: 0 4px 16px #007aff22;
      }
      .lang-select__icon {
        margin-left: 0.7em;
        font-size: 1.2em;
        pointer-events: none;
        color: #888;
        transition: color 0.2s;
      }
      .lang-select__dropdown {
        position: absolute;
        top: 110%;
        left: 0;
        width: 100%;
        background: #fff;
        border: 1.5px solid #ccc;
        border-radius: 8px;
        box-shadow: 0 4px 16px #0002;
        z-index: 1001;
        max-height: 220px;
        overflow-y: auto;
        margin-top: 0.2em;
      }
      .lang-select__option {
        padding: 0.6em 1em;
        cursor: pointer;
        font-size: 1.05em;
        border-radius: 6px;
        transition: background 0.2s, color 0.2s;
      }
      .lang-select__option:hover {
        background: #f0f6ff;
        color: #007aff;
      }

      textarea {
        width: 100%;
        max-width: 720px;
        height: 200px;
        padding: 1rem;
        resize: vertical;
        border: 1px solid #ccc;
        border-radius: 4px;
        font-size: 1rem;
        line-height: 1.5;
        margin-bottom: 2rem;
      }

      .home-btns {
        display: flex;
        gap: 1rem;
      }

      .primary-btn {
        align-self: center;
        padding: 0.75rem 1.5rem;
        font-size: 1rem;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        background: #000;
        color: #fff;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        transition: background 0.3s;
      }
      .primary-btn:hover {
        background: #222;
        box-shadow: 0 2px 8px 0 #0006;
      }

      /* ===== 全螢幕樣式 ===== */
      :fullscreen body {
        background: var(--bg-color, #000);
      }

      .page-full-container {
        position: fixed;
        inset: 0;
        background: var(--bg-color, #000);
        display: flex;
        flex-direction: column;
        z-index: 998;
      }

      .prompt-container {
        width: 100%;
        max-width: 100%;
        padding: 6rem 2rem 2rem;
        margin: 0 auto;
        overflow-y: auto;
        height: 100vh;
      }

      .prompt-text {
        white-space: pre-wrap;
        word-break: break-word;
        line-height: 1.6;
      }

      /* 控制列 */
      .controls {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        background: var(--control-bg);
        color: var(--control-color);
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 1rem;
        padding: 0.5rem 1rem;
        z-index: 1000;
        font-size: 1rem;
      }
      :fullscreen .controls {
        font-size: 2rem;
        background: rgba(34,34,34,0.7);
        transition: background 0.3s;
      }

      .page-full-container .controls {
        background: rgba(34,34,34,0.7);
        transition: background 0.3s;
      }

      .controls button,
      .controls select,
      .controls input[type="range"] {
        font: inherit;
      }

      .controls button {
        border: none;
        border-radius: 4px;
        padding: 0.4em 0.8em;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        transition: background 0.3s;
      }
      .controls button.play {
        background: #28a745;
        color: #fff;
      }
      .controls button.play:hover {
        background: #208838;
      }
      .controls button.pause {
        background: #dc3545;
        color: #fff;
      }
      .controls button.pause:hover {
        background: #b52a37;
      }
      .controls button.exit {
        background: #000;
        color: #fff;
      }
      .controls button.exit:hover {
        background: #222;
        box-shadow: 0 2px 8px 0 #0006;
      }

      .controls label {
        display: flex;
        align-items: center;
        gap: 0.3rem;
      }

      /* 色票選單 */
      .color-option {
        display: flex;
        align-items: center;
        justify-content: space-between;
        height: 1.5em;
      }

      /* 新增 ColorSelect 樣式 */
      .color-select {
        position: relative;
        min-width: 120px;
        user-select: none;
      }
      .color-select__selected {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0.4em 0.8em;
        border-radius: 4px;
        cursor: pointer;
        border: 1px solid #ccc;
        background: #fff;
        color: #333;
        min-width: 100px;
        gap: 0.5em;
        height: 1.5em;
      }
      .color-select__icon {
        margin-left: 0.5em;
        font-size: 1.2em;
        pointer-events: none;
        transition: color 0.2s;
      }
      .color-select__dropdown {
        position: absolute;
        top: 110%;
        left: 0;
        width: 100%;
        background: #fff;
        border: 1px solid #ccc;
        border-radius: 4px;
        box-shadow: 0 2px 8px #0001;
        z-index: 1001;
        max-height: 220px;
        overflow-y: auto;
      }
      .color-select__option {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0.4em 0.8em;
        cursor: pointer;
        gap: 0.5em;
      }
      .color-select__option:hover {
        background: #eee;
      }

      /* RWD */
      @media (max-width: 600px) {
        h1 {
          font-size: 1.5rem;
        }
        .controls {
          gap: 0.5rem;
        }
      }
      .shortcut-hint {
        margin-top: 2.5rem;
        display: inline-block;
        background: #fffbe7;
        border: 1.5px solid #ffe066;
        border-radius: 14px;
        box-shadow: 0 2px 12px #0001;
        padding: 1.2em 2em 1.1em 2em;
        text-align: center;
        font-size: 1.08rem;
        color: #555;
        user-select: none;
        min-width: 260px;
        max-width: 90vw;
      }
      .shortcut-title {
        font-weight: bold;
        color: #b8860b;
        margin-bottom: 0.5em;
        font-size: 1.13em;
        letter-spacing: 0.04em;
      }
      .shortcut-keys {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 1.2em;
        flex-wrap: wrap;
      }
      .keycap {
        display: inline-block;
        background: #f5f5f5;
        border: 1.5px solid #ccc;
        border-radius: 6px;
        box-shadow: 0 1px 2px #0001;
        padding: 0.18em 0.85em;
        margin: 0 0.2em;
        font-family: 'Menlo', 'Consolas', 'monospace';
        font-size: 1.08em;
        color: #222;
        vertical-align: middle;
      }
      .key-desc {
        margin-left: 0.3em;
        color: #666;
        font-size: 0.98em;
      }
      .key-sep {
        width: 2em;
        display: inline-block;
      }
      @media (max-width: 600px) {
        .shortcut-hint {
          padding: 1em 0.5em;
          font-size: 0.98rem;
        }
        .shortcut-keys {
          gap: 0.5em;
        }
      }
      .follow-block {
        display: flex;
        align-items: center;
        gap: 0.7em;
        margin-bottom: 1.5rem;
        justify-content: center;
      }
      .follow-label {
        font-size: 1rem;
        color: #555;
        font-weight: 500;
      }
      .follow-block a {
        color: #555;
        transition: color 0.2s;
      }
      .follow-block a:hover {
        color: #007aff;
      }
      /* 移除 .author-card 外框樣式 */
      .author-card {
        /* background: #fff; */
        /* border-radius: 16px; */
        /* box-shadow: 0 4px 24px #0001, 0 1.5px 6px #0001; */
        /* padding: 1.2em 2em 1.1em 2em; */
        /* margin-bottom: 2rem; */
        /* min-width: 260px; */
        /* max-width: 90vw; */
        /* display: flex; */
        /* flex-direction: column; */
        /* align-items: center; */
      }
      
      /* 讓 .follow-block a 沒有底線 */
      .follow-block a {
        color: #555;
        transition: color 0.2s, transform 0.2s;
        font-size: 1.25em;
        display: flex;
        align-items: center;
        text-decoration: none;
      }
      .follow-block a:hover {
        color: #007aff;
        transform: scale(1.18) rotate(-6deg);
        text-decoration: none;
      }
      @media (max-width: 600px) {
        .author-card {
          padding: 1em 0.5em;
          font-size: 0.98rem;
        }
        .creator {
          font-size: 0.98rem;
        }
        .follow-label {
          font-size: 0.95rem;
        }
      }
    </style>
  </head>
  <body>
    <div id="app">
      <!-- 首頁區 -->
      <section id="home" v-if="!isAnyFull">
        <h1>{{ langPack.title }}</h1>
        <div style="margin-bottom: 1rem; display: flex; align-items: center; gap: 0.5rem;">
          <i class="fa-solid fa-globe" aria-label="language" style="font-size:1.1em;"></i>
          <lang-select
            v-model="language"
            :options="[
              { value: 'zh', label: '中文 / Chinese' },
              { value: 'en', label: '英文 / English' }
            ]"
          ></lang-select>
        </div>
        <div class="author-card">
          <p class="creator">
            {{ langPack.createdBy }}
            <a href="https://facebook.com/deanlinbao" target="_blank">林鼎淵 Dean Lin</a>
          </p>
          <div class="follow-block">
            <span class="follow-label">{{ langPack.follow }}</span>
            <a href="https://facebook.com/deanlinbao" target="_blank" aria-label="Facebook">
              <i class="fab fa-facebook fa-lg"></i>
            </a>
            <a href="https://github.com/dean9703111" target="_blank" aria-label="GitHub">
              <i class="fab fa-github fa-lg"></i>
            </a>
            <a href="https://medium.com/@dean-lin" target="_blank" aria-label="Medium">
              <i class="fab fa-medium fa-lg"></i>
            </a>
            <a href="https://youtube.com/@dlcorner" target="_blank" aria-label="YouTube">
              <i class="fab fa-youtube fa-lg"></i>
            </a>
          </div>
        </div>
        <textarea v-model="script" :placeholder="langPack.placeholder"></textarea>
        <div class="home-btns">
          <button class="primary-btn" @click="enterPageFull"><i class="fa-solid fa-up-right-and-down-left-from-center"></i> {{ langPack.pageFull }}</button>
          <button class="primary-btn" @click="enterScreenFull"><i class="fa-solid fa-expand"></i> {{ langPack.screenFull }}</button>
        </div>
        <!-- 美化後的快捷鍵提示 -->
        <div class="shortcut-hint">
          <div class="shortcut-title">{{ langPack.shortcutTitle }}</div>
          <div class="shortcut-keys">
            <span class="keycap">ESC</span>
            <span class="key-desc">{{ langPack.exit }}</span>
            <span class="key-sep"></span>
            <span class="keycap">Space</span>
            <span class="key-desc">{{ langPack.play }}/{{ langPack.pause }}</span>
          </div>
        </div>
      </section>

      <!-- 全螢幕區（兩種模式共用） -->
      <div :class="{ 'page-full-container': isPageFull }" v-if="isAnyFull">
        <!-- 控制列 -->
        <div class="controls">
          <button :class="playState === 'pause' ? 'play' : 'pause'" @click="togglePlay">
            <i v-if="playState === 'pause'" class="fa-solid fa-play"></i>
            <i v-else class="fa-solid fa-pause"></i>
            {{ playState === 'pause' ? langPack.play : langPack.pause }}
          </button>

          <label>
            <i class="fa-solid fa-font"></i> {{ langPack.font }}
            <input type="range" min="35" max="100" step="1" v-model.number="fontSize" />
          </label>

          <label>
            <i class="fa-solid fa-rocket"></i> {{ langPack.speed }}
            <input type="range" min="1" max="40" step="1" v-model.number="speed" />
          </label>

          <label style="gap:0.3rem;">
            <i class="fa-solid fa-palette"></i> {{ langPack.color }}
            <color-select v-model="bgColor" :colors="colors" :language="language"></color-select>
          </label>

          <button class="exit" @click="exitFull">
            <i class="fa-solid fa-xmark"></i>
            {{ langPack.exit }}
          </button>
        </div>

        <!-- 文字區 -->
        <div
          class="prompt-container"
          :style="{ backgroundColor: bgColor, color: textColor, fontSize: fontSize + 'px' }"
          ref="promptBox"
        >
          <div style="height: 50vh; pointer-events: none; background: transparent;"></div>
          <div class="prompt-text">{{ script }}</div>
          <div style="height: 50vh; pointer-events: none; background: transparent;"></div>
        </div>
        <!-- 右上角顯示預計秒數 -->
        <div style="position: fixed; top: 60px; right: 32px; z-index: 1100; font-size: 2.2rem; color: #fff; background: rgba(0,0,0,0.35); border-radius: 1em; padding: 0.3em 1.1em; pointer-events: none; text-align: center; min-width: 3.5em;">
          {{ totalSeconds }}s
        </div>
      </div>
    </div>

    <!-- Vue 3 CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <script>
      const { createApp, onMounted, ref, watch } = Vue;

      // 新增 ColorSelect 元件
      const ColorSelect = {
        props: {
          modelValue: String,
          colors: Array,
          language: String
        },
        emits: ['update:modelValue'],
        template: `
          <div class="color-select">
            <div
              class="color-select__selected"
              @click="open = !open"
              :style="{background: selectedColor.hex, color: selectedColor.isLight ? '#000' : '#fff'}"
            >
              
            </div>
            <div v-if="open" class="color-select__dropdown">
              <div
                v-for="c in colors"
                :key="c.hex"
                class="color-select__option"
                :style="{background: c.hex, color: c.isLight ? '#000' : '#fff'}"
                @click="selectColor(c.hex)"
              >
              </div>
            </div>
          </div>
        `,
        data() {
          return { open: false };
        },
        computed: {
          selectedColor() {
            return this.colors.find(c => c.hex === this.modelValue) || this.colors[0];
          }
        },
        methods: {
          selectColor(hex) {
            this.$emit('update:modelValue', hex);
            this.open = false;
          },
          handleClickOutside(e) {
            if (!this.$el.contains(e.target)) {
              this.open = false;
            }
          }
        },
        mounted() {
          document.addEventListener('click', this.handleClickOutside);
        },
        beforeUnmount() {
          document.removeEventListener('click', this.handleClickOutside);
        }
      };

      // 新增 LangSelect 組件
      const LangSelect = {
        props: {
          modelValue: String,
          options: Array
        },
        emits: ['update:modelValue'],
        template: `
          <div class="lang-select">
            <div
              class="lang-select__selected"
              @click="open = !open"
            >
              <span>{{ selectedOption.label }}</span>
              <i class="fa-solid fa-chevron-down lang-select__icon"></i>
            </div>
            <div v-if="open" class="lang-select__dropdown">
              <div
                v-for="opt in options"
                :key="opt.value"
                class="lang-select__option"
                @click="selectOption(opt.value)"
              >
                {{ opt.label }}
              </div>
            </div>
          </div>
        `,
        data() {
          return { open: false };
        },
        computed: {
          selectedOption() {
            return this.options.find(o => o.value === this.modelValue) || this.options[0];
          }
        },
        methods: {
          selectOption(val) {
            this.$emit('update:modelValue', val);
            this.open = false;
          },
          handleClickOutside(e) {
            if (!this.$el.contains(e.target)) {
              this.open = false;
            }
          }
        },
        mounted() {
          document.addEventListener('click', this.handleClickOutside);
        },
        beforeUnmount() {
          document.removeEventListener('click', this.handleClickOutside);
        }
      };

      createApp({
        setup() {
          // state
          const script = ref('');
          const isFullScreen = ref(false); // 瀏覽器 fullscreen
          const isPageFull = ref(false);   // 佔據頁面 but 非瀏覽器 fullscreen
          const playState = ref('pause');
          const fontSize = ref(48);
          const speed = ref(10);
          const bgColor = ref('#000000');
          const promptBox = ref(null);
          // 強制刷新用 key
          const refreshKey = ref(0);
          // 語言切換
          const language = ref('zh');
          const langPacks = {
            zh: {
              title: '讀稿提詞機',
              language: '語言',
              createdBy: '作者',
              placeholder: '請貼上稿件...',
              pageFull: '網頁全螢幕',
              screenFull: '畫面全螢幕',
              play: '開始',
              pause: '暫停',
              font: '字體',
              speed: '速度',
              exit: '退出',
              color: '顏色',
              shortcutTitle: '進入全螢幕後可用快捷鍵',
              follow: '追蹤我學習更多資訊',
            },
            en: {
              title: 'Teleprompter',
              language: 'Language',
              createdBy: 'created by',
              placeholder: 'Paste your script here...',
              pageFull: 'Page Fullscreen',
              screenFull: 'Screen Fullscreen',
              play: 'Play',
              pause: 'Pause',
              font: 'Font Size',
              speed: 'Speed',
              exit: 'Exit',
              color: 'Color',
              shortcutTitle: 'Shortcuts in fullscreen',
              follow: 'Follow me for more tips',
            }
          };
          const langPack = Vue.computed(() => langPacks[language.value]);

          const colors = [
            { hex: '#000000', isLight: false },
            { hex: '#ffffff', isLight: true },
            { hex: '#FF3B30', isLight: false },
            { hex: '#FF9500', isLight: false },
            { hex: '#FFCC00', isLight: true },
            { hex: '#34C759', isLight: false },
            { hex: '#007AFF', isLight: false },
            { hex: '#5856D6', isLight: false },
            { hex: '#AF52DE', isLight: false },
            { hex: '#5AC8FA', isLight: false },
            { hex: '#FF2D55', isLight: false },
            { hex: '#8E8E93', isLight: false },
            { hex: '#D1D1D6', isLight: true },
            { hex: '#A2845E', isLight: false },
            { hex: '#DAA520', isLight: false },
            { hex: '#C0C0C0', isLight: true },
          ];

          // 計算文字顏色
          const textColor = Vue.computed(() => {
            const c = colors.find((c) => c.hex === bgColor.value);
            return c && c.isLight ? '#000' : '#fff';
          });

          // 任意全螢幕狀態
          const isAnyFull = Vue.computed(() => isFullScreen.value || isPageFull.value);

          let rafId = null;
          const scrollStep = () => {
            if (playState.value === 'play' && promptBox.value) {
              promptBox.value.scrollTop += speed.value * 0.1;
              const maxScroll = promptBox.value.scrollHeight - promptBox.value.clientHeight;
              if (promptBox.value.scrollTop >= maxScroll) {
                playState.value = 'pause';
                return;
              }
              rafId = requestAnimationFrame(scrollStep);
            }
          };

          const togglePlay = () => {
            playState.value = playState.value === 'pause' ? 'play' : 'pause';
          };

          // 進入畫面（瀏覽器）全螢幕
          const enterScreenFull = () => {
            const el = document.documentElement;
            if (el.requestFullscreen) el.requestFullscreen();
            else if (el.webkitRequestFullscreen) el.webkitRequestFullscreen();
          };

          // 進入網頁全螢幕
          const enterPageFull = () => {
            isPageFull.value = true;
            playState.value = 'pause';
          };

          // 離開全螢幕
          const exitFull = () => {
            if (isFullScreen.value) {
              if (document.exitFullscreen) document.exitFullscreen();
              else if (document.webkitExitFullscreen) document.webkitExitFullscreen();
            } else if (isPageFull.value) {
              isPageFull.value = false;
            }
          };

          // 監聽瀏覽器 fullscreen 變化
          const fsHandler = () => {
            isFullScreen.value = !!document.fullscreenElement;
            playState.value = 'pause';
          };

          const keyHandler = (e) => {
            if (e.key === 'Escape') {
              exitFull();
            }
            // 新增：空白鍵切換開始/暫停
            if ((e.key === ' ' || e.code === 'Space') && isAnyFull.value) {
              e.preventDefault(); // 防止空白鍵造成頁面捲動
              togglePlay();
            }
          };

          watch(playState, (val) => {
            if (val === 'play') {
              rafId = requestAnimationFrame(scrollStep);
            } else if (val === 'pause' && rafId) {
              cancelAnimationFrame(rafId);
              rafId = null;
            }
          });

          // 監聽 fontSize 變化
          watch(fontSize, () => {
            refreshKey.value++;
          });

          // 監聽 window resize
          const resizeHandler = () => {
            refreshKey.value++;
          };
          onMounted(() => {
            document.addEventListener('fullscreenchange', fsHandler);
            document.addEventListener('keydown', keyHandler);
            window.addEventListener('resize', resizeHandler);
            // 不要在這裡啟動 rafId，等 playState 變 'play' 再啟動
          });

          Vue.onUnmounted(() => {
            if (rafId) {
              cancelAnimationFrame(rafId);
              rafId = null;
            }
            document.removeEventListener('fullscreenchange', fsHandler);
            document.removeEventListener('keydown', keyHandler);
            window.removeEventListener('resize', resizeHandler);
          });

          // 新增 totalSeconds 計算
          const totalSeconds = Vue.computed(() => {
            refreshKey.value;
            if (!promptBox.value) return 0;
            const total = promptBox.value.scrollHeight - promptBox.value.clientHeight;
            const pxPerSec = speed.value * 0.1 * 60; // 修正這裡
            if (pxPerSec <= 0) return 0;
            return Math.ceil(total / pxPerSec);
          });

          return {
            script,
            isFullScreen,
            isPageFull,
            isAnyFull,
            playState,
            fontSize,
            speed,
            bgColor,
            togglePlay,
            enterScreenFull,
            enterPageFull,
            exitFull,
            colors,
            textColor,
            promptBox,
            // 語言切換
            language,
            langPack,
            totalSeconds,
          };
        },
        components: {
          ColorSelect,
          LangSelect
        }
      }).mount('#app');
    </script>
  </body>
</html>